<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en-US"><!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <title>Registering MSpec Runners for TestDriven.NET on Windows X64 - Eric Duncan</title>
  <meta name="author" content="Eric Duncan" />
  <meta name="description" content="Jan 20th, 2010 by Eric Duncan in archives Registering MSpec Runners for TestDriven.NET on Windows X64 Please note that this post was migrated to my &hellip;" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="generator" content="Octopress 2.0" />
  <meta property="og:site_name" content="Eric Duncan" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="" />
  <meta property="og:video" content="" />
  <meta property="og:url" content="http://eduncan911.com/blog/archives/registering-mspec-runners-for-testdriven-net-on-windows-x64.html" />
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@eduncan911">
  <meta name="twitter:title" content="Registering MSpec runners for TestDriven.NET on Windows x64">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="">
  <link rel="canonical" href="http://eduncan911.com/blog/archives/registering-mspec-runners-for-testdriven-net-on-windows-x64.html" />
  <link rel="alternate" href="/atom.xml" title="Eric Duncan" type="application/atom+xml" />
  <link rel="shortcut icon" href="/favicon.png" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" type="text/css" />
  <link rel="stylesheet" href="/stylesheets/screen.css" media="screen, projection" type="text/css" />
  <style type="text/css">
    header .blog-title a, header .blog-description { 
      color: #ffffff; 
      text-transform: lowercase;
    } 
  </style>
  <script src="/javascripts/modernizr-2.0.js"></script>

</head>
<body class="home blog">

  <header id="masthead" role="banner" class="site-head site-header">
    <div class="vertical" itemscope itemtype="http://schema.org/Article">
      <div class="site-head-content inner" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <h1 class="blog-title" itemprop="name"><a class="blog-logo" href='/' rel='home'>Eric Duncan</a></h1>
        <h2 class="blog-description" itemprop="jobtitle">spawning a race of beings</h2>
        <meta itemprop="givenname" content="Eric" />
        <meta itemprop="familyname" content="Duncan" />
        <meta itemprop="affiliation" content="eduncan911" />
        <meta itemprop="jobtitle" content="Software Architect" />
      </div>
    </div>
  </header>

  <main id="content" class="content" role="main">
    <article class="post type-post status-publish format-standard hentry category-schweeeet" itemscope itemtype="http://schema.org/Article">
        <header class="post-header">   
        <span class="post-meta">
          <span class="posted-on"><time class="entry-date published date updated" datetime="2010-01-20T17:59:00-05:00" content="2010-01-20T17:59:00-05:00" itemprop="datePublished">Jan 20<span>th</span>, 2010</time></span>
          <span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://plus.google.com/+EricDuncan911?rel=author">Eric Duncan</a></span></span>
          in <a class='category' href='/category/archives/' rel='category tag'>archives</a>
        </span>
        <h1 class="post-title entry-title" itemprop="name"><a href="" rel="bookmark">Registering MSpec Runners for TestDriven.NET on Windows X64</a></h1>
        <meta itemprop="url" content="" />
      </header>
      <section class="post-content" itemprop="articleBody">

<!-- BEGIN MARKDOWN CONTENT: I can't control the formatting here, bleh -->      

<!-- more -->


<blockquote><p>Please note that this post was migrated to my new blog platform. There may be bad formating, broken links, images, downloads and so on.  If you need an item on this page, please contact me and I will do my best to get it from my backups.</p><footer><strong>~E</strong></footer></blockquote>


<P>EDIT:&nbsp;MSpec v0.3 now supports <A href="http://weblogs.asp.net/nunitaddin/archive/2009/11/05/testdriven-net-2-24-xcopy-deployable-test-runners.aspx" mce_href="http://weblogs.asp.net/nunitaddin/archive/2009/11/05/testdriven-net-2-24-xcopy-deployable-test-runners.aspx">TestDriven.Net&#8217;s v2.24 XCopy Deployable Test Runners</A>.&nbsp; So this blog post is legacy information at this time.&nbsp; </P>


<P><IMG style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; DISPLAY: inline; MARGIN-LEFT: 0px; BORDER-TOP: 0px; MARGIN-RIGHT: 0px; BORDER-RIGHT: 0px" title=td_rocket2[1] border=0 alt=td_rocket2[1] align=left src="/blog/archives/images/MSpecrunnersforTestDrive.NETonWindowsx64_AD3B/td_rocket21.gif" width=141 height=100 mce_src="/blog/archives/images/MSpecrunnersforTestDrive.NETonWindowsx64_AD3B/td_rocket21.gif"> Machine.Specifications (MSpec) is my preferred Behavior-Driven Design (BDD) framework for Microsoft.NET.&nbsp; Aaron Jensen, <A href="http://codebetter.com/blogs/aaron.jensen/archive/tags/mspec/default.aspx" target=_blank mce_href="http://codebetter.com/blogs/aaron.jensen/archive/tags/mspec/default.aspx">the author of MSpec</A>, released support for TestDriven.NET, xUnit, nUnit, and Gallio.&nbsp; And with the latest release of v0.3, it adds official support for ReSharper&#8217;s Unit Tests and and Selenium integration testing.&nbsp; Very cool stuff indeed, and a very active project!</P>


<P>What has bugged me a bit is getting TestDriven.NET to see my MSpec specifications, on my Windows 7 x64 platform.&nbsp; Aaron so kindly includes a InstallTDNetRunner.bat file to register MSpec with TestDrive.NET; but, it only works on x86 systems.</P>


<P>So why does it not work with x64 systems?&nbsp; It is because the installer for TestDriven.NET registers the runners in a different registry location.</P>


<H2>Windows Vista/7 x64 (64-bit) MSpec runner TestDriven.NET registry file</H2>


<P>Below, I have created a bat file you can copy and paste into your own InstallTDNetRunner-x64.bat if you are on Windows x64.&nbsp; Or, you can download it from here: </P>


<P><A href="/blog/binary/legacy/InstallTDNetRunner-x64.zip">/blog/binary/legacy/InstallTDNetRunner-x64.zip</A> </P>


<PRE><CODE>

@echo off &amp; if not &#8220;%ECHO%&#8221;==&#8221;&#8221; echo %ECHO%

setlocal
set LOCALDIR=%~dp0

echo Windows Registry Editor Version 5.00 &gt; MSpecTDNet.reg
echo [HKEY_CURRENT_USER\Software\MutantDesign\TestDriven.NET\TestRunners\MSpec] &gt;&gt; MSpecTDNet.reg
echo &#8220;Application&#8221;=&#8221;&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;AssemblyPath&#8221;=&#8221;%LOCALDIR:\=&#92;%Machine.Specifications.TDNetRunner.dll&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TargetFrameworkAssemblyName&#8221;=&#8221;Machine.Specifications&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TypeName&#8221;=&#8221;Machine.Specifications.TDNetRunner.SpecificationRunner&#8221; &gt;&gt; MSpecTDNet.reg
echo @=&#8221;5&#8221; &gt;&gt; MSpecTDNet.reg
echo. &gt;&gt; MSpecTDNet.reg

echo [HKEY_LOCAL_MACHINE\SOFTWARE\MutantDesign\TestDriven.NET\TestRunners\MSpec] &gt;&gt; MSpecTDNet.reg
echo &#8220;Application&#8221;=&#8221;&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;AssemblyPath&#8221;=&#8221;%LOCALDIR:\=&#92;%Machine.Specifications.TDNetRunner.dll&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TargetFrameworkAssemblyName&#8221;=&#8221;Machine.Specifications&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TypeName&#8221;=&#8221;Machine.Specifications.TDNetRunner.SpecificationRunner&#8221; &gt;&gt; MSpecTDNet.reg
echo @=&#8221;5&#8221; &gt;&gt; MSpecTDNet.reg
echo. &gt;&gt; MSpecTDNet.reg

echo [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MutantDesign\TestDriven.NET\TestRunners\MSpec] &gt;&gt; MSpecTDNet.reg
echo &#8220;Application&#8221;=&#8221;&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;AssemblyPath&#8221;=&#8221;%LOCALDIR:\=&#92;%Machine.Specifications.TDNetRunner.dll&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TargetFrameworkAssemblyName&#8221;=&#8221;Machine.Specifications&#8221; &gt;&gt; MSpecTDNet.reg
echo &#8220;TypeName&#8221;=&#8221;Machine.Specifications.TDNetRunner.SpecificationRunner&#8221; &gt;&gt; MSpecTDNet.reg
echo @=&#8221;5&#8221; &gt;&gt; MSpecTDNet.reg

regedit MSpecTDNet.reg

del MSpecTDNet.reg


</CODE></PRE>


<H2>Setup TestDriven.NET and MSpec</H2>


<P>Still a bit confused, getting TestDriven.NET and MSpec setup for the first time? Here&#8217;s the steps to follow:</P>


<UL>
<LI>Go ahead and install TestDriven.NET.&nbsp; It can be installed and upgraded at any time. </LI>
<LI>Next, grab <A href="http://codebetter.com/blogs/aaron.jensen/archive/tags/mspec/default.aspx" target=_blank mce_href="http://codebetter.com/blogs/aaron.jensen/archive/tags/mspec/default.aspx">the latest release of MSpec</A>&nbsp; and extract the zip to a semi-permanent location.&nbsp; This is because things such as ReSharper and TestDriven.NET will need to know a common location for the mspec assemblies.&nbsp; I recommend C:\Program Files (x86)\MSpec&#46; 
<UL>
<LI>Included with the MSpec zip is an InstallTDNetRunner.bat, but it only works on 32-bit Windows.&nbsp; For 64-bit Windows, you want to copy my registry code above into a new file called InstallTDNetRunner-x64.bat. </LI>
<LI>Make sure to place this InstallTDNetRunner-x64.bat file in the same directory as your semi-permanent MSpec location above. </LI></UL></LI>
<LI>Finally, you want to double-click and execute the InstallTDNetRunner or InstallTDNetRunner-x64 from within this semi-permanent location.&nbsp; This will insert the registry values for a new runner called MSpec for TestDriven.NET to detect and execute. </LI></UL>


<P>From this point further, you can right-click within different places to execute your specifications within your MSpec.&nbsp; Some tips on locations you can right-click and execute the specs:</P>


<UL>
<LI>The project file: will execute all specs detected within that project. </LI>
<LI>The Namespace: will execute all specs detected within that namespace throughout the project. </LI>
<LI>Within the <FONT face="Courier New">Establish context</FONT> or <FONT face="Courier New">Because of</FONT> : Will execute all specs within that one class/scenario. </LI>
<LI>Within the <FONT face="Courier New">It</FONT> spec - Will execute just that one test. </LI></UL>


<P>Something to note is Aaron is currently upgrading MSpec (version 0.4, not released yet) to support TestDriven.NET&#8217;s new 2.24 feature of version independent runners. I haven&#8217;t looked completely into that myself, but should make registring TDNet runners in the future a bit easier.</P>



<!-- END MARKDOWN CONTENT -->

      </section>

      <section class="collapsable history">
        <h5><a class="collapsable-trigger" href="#">&gt; Revision History</a></h5>
        <ul class="post-metadata"><li><strong>Wed Apr 9 20:49:43 2014</strong><br/>imported into new blog platform
</li></ul><p class="post-metadata">View on <a href=https://github.com/eduncan911/eduncan911.github.io/commits/source/source/_posts/2010-01-20-registering-mspec-runners-for-testdriven-net-on-windows-x64.markdown target=_blank>Github</a></p>
      </section>

      <section class="collapsable author">
        <h5><a class="collapsable-trigger" href="#">&gt; About the author</a></h5>
        <p class="post-metadata">Eric has been in a wide variety of software development roles with 18+ years experience developing and managing technologies for several industries such as prepaid card services, advertising, legal and manufacturing. He is a pioneer of open-sourced social networking and communication solutions.</p>
      </section>

      <!-- <section class="collapsable author">
        <h5><a class="collapsable-trigger" href="#">&gt; Related Posts</a></h5>
        <p class="post-metadata">(coming soon)</p>
      </section> -->
      <nav class="pagination navigation paging-navigation" role="navigation">
        <div class="nav-links">
          <div class="older-posts"><a href="/blog/archives/windows-azure-sdk-for-microsoft-visual-studio-november-2009.html" title="Previous Post: Windows Azure SDK for Microsoft Visual Studio November 2009">&laquo; Windows Azure SDK for Microsoft Visual Studio November 2009</a></div>
          <div class="newer-posts"><a href="/blog/archives/managed-extensibility-framework-mef-microsofts-official-inversion-of-control-container.html" title="Next Post: Managed Extensibility Framework (MEF) - Microsoft's Official Inversion of Control Container">Managed Extensibility Framework (MEF) - Microsoft's Official Inversion of Control Container &raquo;</a></div>
        </div>
      </nav>
      <div class="clear"></div>

      <a class="post-comment-anchor" name="comments"></a>
      <section class="post-comment">
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>

    </article>
  </main>

  <footer id="colophon" class="site-footer" role="contentinfo">
    <a class="subscribe icon-feed" href="/atom.xml"><span class="tooltip">Subscribe!</span></a>
    <div><a href="/blog">Blog</a></div>
    <div><a href="/stem">STEM</a></div>
    <div><a href="/blog/archives">Archives</a></div>
    <div><a href="/contact">Contact Me</a></div>
    <div><a href="/buymeabeer">Buy Me a Beer</a></div>
    <div><a href="/blogtegrity">Blogtegrity</a></div>
    <div><a href="/keys">PGP Keys</a></div>
    <div><a href="/privacy">Privacy</a></div>
    <div>&nbsp;</div>
    <div class="site-info inner"><section class="copyright">© 2017 Eric Duncan <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a></section></div>
    <div>a <a href="http://www.forgetfoo.me/" title="one of a 100 kickass designs by this guy">forgetfoo</a> design</div>
  </footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script type='text/javascript' src='/javascripts/foo.casper.js?ver=20140422'></script>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3705711-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

  <script type="text/javascript">
    var disqus_shortname = 'eduncan911com';
    
      
      // var disqus_developer = 1;
      var disqus_identifier = 'http://eduncan911.com/blog/archives/registering-mspec-runners-for-testdriven-net-on-windows-x64.html';
      var disqus_url = 'http://eduncan911.com/blog/archives/registering-mspec-runners-for-testdriven-net-on-windows-x64.html';
      var disqus_script = 'embed.js';
    
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
  </script>




</body>
</html>
